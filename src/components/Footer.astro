---
import { COMPANY, TARGET_GROUPS } from '../data/company.js';

const currentYear = new Date().getFullYear();

const footerLinks = {
  company: [
    { label: 'Leistungen', href: '#leistungen' },
    { label: 'Über uns', href: '#trust' },
    { label: 'Kontakt', href: '#kontakt' }
  ],
  legal: [
    { label: 'Impressum', href: '/impressum' },
    { label: 'Datenschutz', href: '/datenschutz' },
    { label: 'Cookie-Einstellungen', href: '#', id: 'cookie-settings-link' }
  ]
};
---

<footer class="footer" role="contentinfo">
  <div class="footer__main">
    <div class="container">
      <div class="footer__grid">
        <!-- Company Info -->
        <div class="footer__brand">
          <a href="/" class="footer__logo">
            <img 
              src="/images/logo.jpg" 
              alt={`${COMPANY.name} Logo`}
              class="footer__logo-img"
              width="150"
              height="42"
              onerror="this.classList.add('footer__logo-img--error'); this.nextElementSibling.style.display='flex';"
            />
            <!-- Fallback Text Logo -->
            <span class="footer__logo-text" style="display: none;">
              <span class="footer__logo-brand">EKA</span>
              <span class="footer__logo-sub">Facility Management</span>
            </span>
          </a>
          <p class="footer__description">
            Professionelle Facility-Management-Lösungen für Immobilien-Profis. 
            Zuverlässig, effizient und partnerschaftlich.
          </p>
          <div class="footer__contact-mini">
            <p>{COMPANY.address.street}</p>
            <p>{COMPANY.address.zip} {COMPANY.address.city}</p>
          </div>
        </div>
        
        <!-- Navigation -->
        <div class="footer__nav">
          <h3 class="footer__heading">Navigation</h3>
          <ul class="footer__nav-list">
            {footerLinks.company.map((link) => (
              <li>
                <a href={link.href} class="footer__link">{link.label}</a>
              </li>
            ))}
          </ul>
        </div>
        
        <!-- Contact -->
        <div class="footer__contact">
          <h3 class="footer__heading">Kontakt</h3>
          <ul class="footer__contact-list">
            <li>
              <a href={`tel:${COMPANY.contact.phoneRaw}`} class="footer__contact-link">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
                <span>{COMPANY.contact.phone}</span>
              </a>
            </li>
            <li>
              <a href={`mailto:${COMPANY.contact.email}`} class="footer__contact-link">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>
                <span>{COMPANY.contact.email}</span>
              </a>
            </li>
            <li>
              <a href={COMPANY.contact.whatsappLink} class="footer__contact-link footer__contact-link--whatsapp" target="_blank" rel="noopener noreferrer">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
                <span>WhatsApp</span>
              </a>
            </li>
          </ul>
        </div>
        
        <!-- Target Groups -->
        <div class="footer__target-groups">
          <h3 class="footer__heading">Für wen wir arbeiten</h3>
          <ul class="footer__target-list">
            {TARGET_GROUPS.map((group) => (
              <li class="footer__target-item">{group}</li>
            ))}
          </ul>
        </div>
      </div>
    </div>
  </div>
  
  <div class="footer__bottom">
    <div class="container footer__bottom-inner">
      <p class="footer__copyright">
        © {currentYear} {COMPANY.name} – {COMPANY.legalForm} {COMPANY.owner}
      </p>
      <nav class="footer__legal-nav" aria-label="Rechtliche Informationen">
        <ul class="footer__legal-list">
          {footerLinks.legal.map((link) => (
            <li>
              <a 
                href={link.href} 
                class="footer__legal-link"
                id={link.id || undefined}
              >
                {link.label}
              </a>
            </li>
          ))}
        </ul>
      </nav>
    </div>
  </div>
</footer>

<style>
  .footer {
    background-color: var(--brand-1);
    color: var(--white);
  }
  
  .footer__main {
    padding: var(--space-16) 0;
  }
  
  .footer__grid {
    display: grid;
    gap: var(--space-8);
  }
  
  @media (min-width: 768px) {
    .footer__grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }
  
  @media (min-width: 1024px) {
    .footer__grid {
      grid-template-columns: 2fr 1fr 1fr 1fr;
    }
  }
  
  .footer__logo {
    display: inline-flex;
    flex-direction: column;
    margin-bottom: var(--space-4);
  }
  
  .footer__logo-img {
    max-height: 42px;
    width: auto;
    object-fit: contain;
    display: block;
    border-radius: var(--radius-md);
  }
  
  .footer__logo-img--error {
    display: none !important;
  }
  
  .footer__logo-text {
    display: flex;
    flex-direction: column;
  }
  
  .footer__logo-brand {
    font-size: var(--font-size-3xl);
    font-weight: 800;
    color: var(--white);
    line-height: 1;
  }
  
  .footer__logo-sub {
    font-size: var(--font-size-sm);
    font-weight: 500;
    color: var(--gray-300);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }
  
  .footer__description {
    color: var(--gray-300);
    margin-bottom: var(--space-4);
    line-height: var(--line-height-relaxed);
    max-width: 300px;
  }
  
  .footer__contact-mini {
    color: var(--gray-400);
    font-size: var(--font-size-sm);
  }
  
  .footer__contact-mini p {
    margin: 0;
  }
  
  .footer__heading {
    font-size: var(--font-size-base);
    font-weight: 600;
    color: var(--white);
    margin-bottom: var(--space-4);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }
  
  .footer__nav-list,
  .footer__contact-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
  }
  
  .footer__link,
  .footer__contact-link {
    color: var(--gray-300);
    transition: color var(--transition-fast);
    display: flex;
    align-items: center;
    gap: var(--space-2);
  }
  
  .footer__link:hover,
  .footer__contact-link:hover {
    color: var(--white);
  }
  
  .footer__contact-link--whatsapp {
    color: #25D366;
  }
  
  .footer__contact-link--whatsapp:hover {
    color: #128C7E;
  }
  
  .footer__target-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
  }
  
  .footer__target-item {
    color: var(--gray-300);
    font-size: var(--font-size-sm);
    padding-left: var(--space-4);
    position: relative;
  }
  
  .footer__target-item::before {
    content: '›';
    position: absolute;
    left: 0;
    color: var(--brand-2);
    font-weight: 600;
  }
  
  .footer__bottom {
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    padding: var(--space-6) 0;
  }
  
  .footer__bottom-inner {
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
    align-items: center;
    text-align: center;
  }
  
  @media (min-width: 768px) {
    .footer__bottom-inner {
      flex-direction: row;
      justify-content: space-between;
      text-align: left;
    }
  }
  
  .footer__copyright {
    color: var(--gray-400);
    font-size: var(--font-size-sm);
    margin: 0;
  }
  
  .footer__legal-list {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: var(--space-4);
  }
  
  @media (min-width: 768px) {
    .footer__legal-list {
      justify-content: flex-end;
    }
  }
  
  .footer__legal-link {
    color: var(--gray-400);
    font-size: var(--font-size-sm);
    transition: color var(--transition-fast);
  }
  
  .footer__legal-link:hover {
    color: var(--white);
  }
</style>

<script>
  // Cookie settings link handler
  const cookieSettingsLink = document.getElementById('cookie-settings-link');
  if (cookieSettingsLink) {
    cookieSettingsLink.addEventListener('click', (e) => {
      e.preventDefault();
      // Dispatch custom event to open cookie banner
      window.dispatchEvent(new CustomEvent('openCookieSettings'));
    });
  }
</script>
